name: Complete Check Enforcer

on:
  check_suite:
    types: [completed]
  pull_request:
    types: [opened, synchronize, reopened]

  workflow_dispatch:

jobs:
  check-enforcer:
    name: Check Enforcer
    runs-on: ubuntu-latest

    steps:
      - name: Sparse Checkout Tools
        run: |
          git clone --no-checkout --filter=tree:0 https://github.com/benbp/azure-sdk-tools .
          git sparse-checkout init
          git sparse-checkout set '/.github/*' '/tools/check-enforcer-action'
          git checkout main

      - uses: ./.github/actions/check-enforcer-create
        if: ${{ github.event.pull_request }}

      - uses: ./.github/actions/check-enforcer-complete
        if: ${{ github.event.check_suite }}
